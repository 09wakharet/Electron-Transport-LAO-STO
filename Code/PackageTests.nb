(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[      9187,        214]
NotebookOptionsPosition[      8941,        201]
NotebookOutlinePosition[      9286,        216]
CellTagsIndexPosition[      9243,        213]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"ParentDirectory", "[", 
    RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Get", "[", 
   RowBox[{"\"\<Methods.m\>\"", ",", 
    RowBox[{"Path", "\[Rule]", 
     RowBox[{"FileNameJoin", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Directory", "[", "]"}], ",", "\"\<Packages\>\""}], "}"}], 
      "]"}]}]}], "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]1", "=", "10."}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Epsilon]2", "=", "5."}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "=", "12."}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Height", " ", "of", " ", "first", " ", "layer", " ", "in", " ", 
    "angstroms"}], "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "=", " ", "3.904"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"unit", " ", "cell", " ", "size", " ", "in", " ", "angstroms"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"t1", "=", ".25"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"hopping", " ", "parameters", " ", "in", " ", "eV"}], 
   "*)"}]}], "\n", 
 RowBox[{
  RowBox[{"t2", "=", ".025"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"MM", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"NN", "=", "5"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"\[Beta]", "=", ".95"}], ";", 
  RowBox[{"(*", 
   RowBox[{
   "percent", " ", "of", " ", "the", " ", "old", " ", "distribution", " ", 
    "to", " ", "keep", " ", "when", " ", "calculating", " ", "the", " ", 
    "new", " ", "distribution"}], "*)"}], "\n", 
  RowBox[{"numPartitions", "=", "20"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"numStates", "=", "20"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetParameters", "[", 
   RowBox[{
   "\[Epsilon]1", ",", "\[Epsilon]2", ",", "H", ",", " ", "a", ",", "  ", 
    "t1", ",", "t2", ",", " ", "MM", ",", " ", "NN", ",", " ", "\[Beta]", ",",
     " ", "numPartitions", ",", " ", "numStates"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Initialize", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstGuess", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"Table", "[", "\n", "\t ", 
      RowBox[{"1", ",", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "NN"}], "}"}], ",", "\n", "\t", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"MM", "-", "1"}]}], "}"}]}], "\n", "]"}], ",", "1"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"firstGuess", "=", 
   RowBox[{
    FractionBox["totalCharge", 
     RowBox[{"firstGuess", "//", "Total"}]], "firstGuess"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{",", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"firstGuess", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.00003631921851903803`"}], ",", 
       "0.0018055036528251379`", ",", "0.259154524402597`", ",", 
       "4.019333165727297`", ",", "0.2591545991243296`", ",", 
       "0.0018055330124070643`", ",", 
       RowBox[{"-", "0.00003629282519286912`"}], ",", 
       RowBox[{"-", "0.000042057652056673705`"}], ",", 
       RowBox[{"-", "0.000039575572026136046`"}], ",", 
       "0.0002460281930993723`", ",", "0.004006077793799679`", ",", 
       "0.0002460266188733685`", ",", 
       RowBox[{"-", "0.00003958053250032442`"}], ",", 
       RowBox[{"-", "0.000042072428622493346`"}], ",", 
       RowBox[{"-", "0.00004208180392081396`"}], ",", 
       RowBox[{"-", "0.00004208109755297448`"}], ",", 
       RowBox[{"-", "0.00004200967356546143`"}], ",", 
       RowBox[{"-", "0.0000411360405806002`"}], ",", 
       RowBox[{"-", "0.00004200967436774408`"}], ",", 
       RowBox[{"-", "0.000042081100451895214`"}], ",", 
       RowBox[{"-", "0.0000420818162686877`"}], ",", 
       RowBox[{"-", "0.00004208181932486957`"}], ",", 
       RowBox[{"-", "0.00004208181924870325`"}], ",", 
       RowBox[{"-", "0.000042081812191950744`"}], ",", 
       RowBox[{"-", "0.00004208173057204903`"}], ",", 
       RowBox[{"-", "0.000042081812192071857`"}], ",", 
       RowBox[{"-", "0.00004208181924919117`"}], ",", 
       RowBox[{"-", "0.00004208181932767223`"}]}], "}"}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"listvals", ",", "errorList"}], "}"}], "=", 
    RowBox[{"SelfConsistentDistribution", "[", 
     RowBox[{"firstGuess", ",", ".00000005"}], "]"}]}], 
   ";"}]}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<Distribution.txt\>\"", ",", "listvals", ",", "\"\<List\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{"\"\<ErrorList.txt\>\"", ",", "errorList", ",", "\"\<List\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"PlotFullSpaceDistribution", "[", "listvals", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bandList", "=", 
   RowBox[{"BandStructureList", "[", "listvals", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"BandStructurePlot", "[", 
  RowBox[{"0", ",", "1", ",", "bandList"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.652459256521038*^9, 3.652459299477333*^9}, {
   3.6524603235227275`*^9, 3.65246032434581*^9}, {3.6524681612654424`*^9, 
   3.652468162161532*^9}, {3.652546313458059*^9, 3.652546325732286*^9}, {
   3.652546426713383*^9, 3.6525464834180527`*^9}, {3.6525465398576965`*^9, 
   3.652546569205631*^9}, {3.652549812493927*^9, 3.652549814193097*^9}, {
   3.652549916202297*^9, 3.6525499212167983`*^9}, {3.6525500104057164`*^9, 
   3.652550012264902*^9}, {3.6530637627070975`*^9, 3.653063763292156*^9}, 
   3.6531561204781485`*^9, 3.6531570689659877`*^9, {3.6531573488139696`*^9, 
   3.653157349278016*^9}, {3.6531579199540777`*^9, 3.6531579233174143`*^9}, {
   3.6531580026693487`*^9, 3.6531580039624777`*^9}, {3.6531584862857056`*^9, 
   3.653158488209898*^9}, {3.653754368111193*^9, 3.653754368658248*^9}, {
   3.6537544698433657`*^9, 3.6537544755579367`*^9}, 3.653754517009082*^9, {
   3.6537546532457037`*^9, 3.6537546643288116`*^9}, {3.6537559736017265`*^9, 
   3.653755982049571*^9}, {3.653756096204985*^9, 3.6537561055529203`*^9}, {
   3.6537561863650007`*^9, 3.653756248055169*^9}, 3.6537576075651064`*^9, {
   3.653757907339081*^9, 3.653757913053652*^9}, {3.653762843324133*^9, 
   3.6537628590837092`*^9}, 3.6537632431201086`*^9, {3.653763283204117*^9, 
   3.6537632840141983`*^9}, {3.653763358210617*^9, 3.6537633625990553`*^9}, {
   3.6537634250212975`*^9, 3.65376343115091*^9}, {3.653763532801074*^9, 
   3.653763590086802*^9}, {3.653763640210814*^9, 3.653763646039397*^9}, {
   3.6537644660843935`*^9, 3.6537644662164063`*^9}, {3.6539934087376733`*^9, 
   3.6539934091607156`*^9}, {3.6539934645422535`*^9, 3.65399347281208*^9}, {
   3.653993815217317*^9, 3.6539938451353083`*^9}, 3.6539956517889557`*^9, 
   3.653995719007677*^9, {3.653996199336705*^9, 3.653996214819253*^9}, 
   3.653996892034968*^9, {3.6539969594177055`*^9, 3.6539969610708714`*^9}, {
   3.6539995861503525`*^9, 3.6539996126280003`*^9}, {3.6539999316498995`*^9, 
   3.6539999326089954`*^9}, 3.654007018954559*^9, {3.6543578617892895`*^9, 
   3.654357894410551*^9}, {3.654358000105119*^9, 3.654358005001609*^9}, 
   3.654358098929001*^9, {3.65435831374448*^9, 3.654358319010007*^9}, {
   3.6543584753126354`*^9, 3.654358476668771*^9}, {3.654358547514855*^9, 
   3.6543585532304263`*^9}, {3.654358611427245*^9, 3.654358614433546*^9}, {
   3.6543586656156635`*^9, 3.654358667164819*^9}, {3.6543587510842094`*^9, 
   3.6543587515832596`*^9}, {3.6543589845155506`*^9, 
   3.6543589857736764`*^9}, {3.654359053030401*^9, 3.654359075629661*^9}, {
   3.6543661981888456`*^9, 3.6543662046314898`*^9}, {3.6543663882388487`*^9, 
   3.654366393882413*^9}, {3.654367374082423*^9, 3.6543674292919436`*^9}, {
   3.6543674714041543`*^9, 3.654367474299444*^9}, {3.6543675190679207`*^9, 
   3.654367520443058*^9}, {3.654367920437053*^9, 3.6543679218381934`*^9}, {
   3.6543679748884983`*^9, 3.6543679795329623`*^9}, {3.6549629794293494`*^9, 
   3.6549630340888147`*^9}, 3.6549631211005154`*^9, 3.6549643146938624`*^9, {
   3.654964802537642*^9, 3.6549648041858068`*^9}, {3.654964980699456*^9, 
   3.654964987197106*^9}, {3.6549655504464254`*^9, 3.6549655518295636`*^9}},
 EmphasizeSyntaxErrors->True]
},
WindowSize->{624, 946},
WindowMargins->{{51, Automatic}, {Automatic, 330}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 8380, 179, 1009, "Input"]
}
]
*)

(* End of internal cache information *)
